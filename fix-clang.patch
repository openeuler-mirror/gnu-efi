Only in gnu-efi-3.0.8: build.log
Only in gnu-efi-3.0.8: gnu-efi-3.0.8.tar.bz2
diff -u -r gnu-efi-3.0.8/Make.defaults gnu-efi-3.0.8/Make.defaults
--- gnu-efi-3.0.8/Make.defaults	2018-03-15 02:54:51.000000000 +0800
+++ gnu-efi-3.0.8/Make.defaults	2023-05-16 16:28:50.000000000 +0800
@@ -51,8 +51,8 @@
 INSTALL	     := install
 
 # Compilation tools
-HOSTCC       := $(prefix)gcc
-CC           := $(prefix)$(CROSS_COMPILE)gcc
+HOSTCC       ?= $(prefix)gcc
+CC           ?= $(prefix)$(CROSS_COMPILE)gcc
 AS           := $(prefix)$(CROSS_COMPILE)as
 LD           := $(prefix)$(CROSS_COMPILE)ld
 AR           := $(prefix)$(CROSS_COMPILE)ar
@@ -110,10 +110,10 @@
                             || ( [ $(GCCVERSION) -eq "4" ]      \
                                  && [ $(GCCMINOR) -ge "7" ] ) ) \
                           && echo 1)
-  ifeq ($(GCCNEWENOUGH),1)
-    CPPFLAGS += -DGNU_EFI_USE_MS_ABI -maccumulate-outgoing-args --std=c11
-  else ifeq ($(USING_CLANG),clang)
-    CPPFLAGS += -DGNU_EFI_USE_MS_ABI --std=c11
+	ifeq ($(USING_CLANG),clang)
+		CPPFLAGS += -DGNU_EFI_USE_MS_ABI --std=c11
+	else ifeq ($(GCCNEWENOUGH),1)
+		CPPFLAGS += -DGNU_EFI_USE_MS_ABI -maccumulate-outgoing-args --std=c11
   endif
 
   CFLAGS += -mno-red-zone
@@ -148,7 +148,11 @@
 endif
 
 ifneq ($(ARCH),arm)
-export LIBGCC=$(shell $(CC) $(ARCH3264) -print-libgcc-file-name)
+	ifeq ($(CC),clang)
+		export LIBGCC=$(shell $(CC) -print-file-name=libclang_rt.builtins-$(HOSTARCH).a)
+	else
+		export LIBGCC=$(shell $(CC) $(ARCH3264) -print-libgcc-file-name)
+	endif
 endif
 
 ifeq ($(ARCH),arm)
